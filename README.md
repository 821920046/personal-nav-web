# 全栈智能导航网站

一个功能完善的个人导航网站，支持用户认证、分类管理、网站管理、**拖拽排序**、**数据导入/导出**和个性化设置。采用 Matrix 数字雨背景效果，提供极具科技感的用户体验。

## 最新更新（v3.1.0 - 2025-11-02）

### 游客模式与加载优化 🌐
- 🎉 **游客模式访问**：无需登录即可浏览所有导航内容，降低使用门槛
- ⚡ **流畅加载进度条**：0-100%动态进度显示，带闪光动画效果
- 🎯 **导航栏优化**：只有登录用户显示"管理"按钮，界面更简洁
- 📊 **访问统计保护**：游客点击网站不更新访问次数，保持数据准确性
- 🔒 **权限控制**：管理后台依然需要登录，数据安全有保障

### 历史版本
#### v3.0.0 (2025-11-02)
- ✨ **简化导航栏**: 只保留"Home"按钮，界面更简洁清爽
- 🔥 **最近访问功能**: 智能显示访问频率最高的8个网站，右上角显示访问次数徽章
- 📱 **优化展示方式**: 所有分类一次性展示，无需切换，自动隐藏空分类
- 📥 **书签导入增强**: 支持Chrome/Edge/Firefox书签HTML导入，自动创建分类
#### v2.3.0 (2025-11-02)
- ✅ **UI布局优化**: 缩小标题和搜索框，放大网站图标

#### v2.2.0 (2025-11-01)
- ✅ **智能天气系统**: 右上角实时天气显示
- ✅ **动态天气图标**: 根据天气自动切换图标
- ✅ **拖拽排序**: 支持分类和网站拖拽排序
- ✅ **数据导入/导出**: JSON和HTML书签导入

## 功能特性

### 核心功能
- **游客模式访问**: 无需登录即可浏览导航，支持搜索和访问外部链接
- **流畅加载体验**: 动态进度条（0-100%）带闪光动画，Matrix背景效果
- **最近访问**: 智能显示访问频率最高的网站，一键直达常用站点
- **智能导航**: 简洁的Home导航，所有分类一次性展示，无需切换
- **智能天气系统**: 右上角实时天气显示，自动获取天气数据，支持动画效果
- **天气状态感知**: 根据天气状况显示不同图标（太阳、雨云、雪花、闪电等）
- **用户认证系统**: 邮箱密码注册/登录，基于 Supabase Auth
- **分类管理**: 创建、编辑、删除、**拖拽排序**导航分类
- **网站管理**: 添加、编辑、删除、**拖拽排序**网站链接，支持自定义 emoji 图标
- **个性化设置**: 自定义网站标题、Logo、城市、天气、搜索引擎
- **数据管理**: 完整的**数据导入/导出**功能，支持JSON和浏览器书签HTML导入
- **访问统计**: 记录网站访问次数（仅登录用户），智能排序
- **Matrix 背景**: 经典 Matrix 数字雨动画效果
- **响应式设计**: 完美适配桌面和移动设备

### 用户体验优化
- 游客模式无门槛访问，快速体验网站功能
- 动态加载进度条，视觉反馈明确，减少等待焦虑
- 最近访问智能推荐，高频网站快速访问
- 所有分类一页展示，信息层次清晰
- 访问次数徽章，使用频率一目了然（仅登录用户）
- 流畅的拖拽排序体验（@dnd-kit）
- 实时加载状态反馈（全局遮罩 + 按钮状态）
- 操作确认提示（删除、导入等）
- 详细的错误提示和处理
- 键盘无障碍支持

## 技术栈

- **前端**: React 18 + TypeScript + Vite
- **样式**: Tailwind CSS
- **后端**: Supabase (PostgreSQL + Auth + RLS)
- **路由**: React Router v6
- **图标**: Lucide React
- **拖拽**: @dnd-kit
- **部署**: Cloudflare Pages

## 快速开始

### 前置要求

- Node.js 18+
- pnpm (推荐) 或 npm
- Supabase 账号

### 本地开发

1. 克隆项目并安装依赖：

```bash
pnpm install
```

2. 配置环境变量：

复制 `.env.example` 为 `.env`，并填入你的 Supabase 凭证：

```
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

3. 启动开发服务器：

```bash
pnpm dev
```

4. 访问 `http://localhost:5173`

### 数据库配置

数据库迁移已自动应用，包含以下表：

- `categories` - 导航分类（含 order_index 排序字段）
- `sites` - 网站链接（含 order_index 排序字段）
- `settings` - 用户设置

所有表都配置了行级安全策略（RLS），确保用户只能访问自己的数据。

## 部署到 Cloudflare Pages

详细部署说明请查看 [CLOUDFLARE_DEPLOY.md](./CLOUDFLARE_DEPLOY.md)

### 快速部署步骤

1. 构建项目：

```bash
pnpm build
```

2. 在 Cloudflare Pages 创建新项目

3. 配置构建设置：
   - 构建命令：`pnpm build`
   - 输出目录：`dist`

4. 添加环境变量：
   - `VITE_SUPABASE_URL`
   - `VITE_SUPABASE_ANON_KEY`

5. 部署完成！

## 项目结构

```
nav-website-fullstack/
├── src/
│   ├── components/          # 可复用组件
│   │   ├── MatrixRain.tsx   # Matrix 背景效果
│   │   └── ProtectedRoute.tsx # 路由保护
│   ├── contexts/            # React Context
│   │   └── AuthContext.tsx  # 认证上下文
│   ├── lib/                 # 工具库
│   │   └── supabase.ts      # Supabase 客户端
│   ├── pages/               # 页面组件
│   │   ├── Home.tsx         # 首页（导航页）
│   │   ├── Login.tsx        # 登录页
│   │   ├── Register.tsx     # 注册页
│   │   └── Admin.tsx        # 管理后台（包含拖拽和导入导出）
│   ├── App.tsx              # 路由配置
│   └── main.tsx             # 应用入口
├── public/
├── README.md
├── CLOUDFLARE_DEPLOY.md
├── COMPLETE_VERSION_DELIVERY.md  # 完整版本交付文档
└── DEPLOYMENT_SUMMARY.md
```

## 使用说明

### 首次使用

1. 访问网站并点击「注册」
2. 使用邮箱和密码创建账号
3. 登录后会自动创建默认设置
4. 访问 `/admin` 路径进入管理后台

### 分类管理

- 点击「分类管理」标签
- 添加新分类，如「常用工具」「开发资源」等
- 可编辑分类名称或删除分类
- **拖动分类左侧的图标可以重新排序**

### 网站管理

- 点击「网站管理」标签
- 选择要添加网站的分类
- 填写网站名称、URL 和 emoji 图标
- 支持编辑和删除网站
- **拖动网站卡片可以重新排序**

### 个性化设置

- 点击「设置」标签
- 自定义网站标题和 Logo
- 设置城市、温度、天气信息
- 选择默认搜索引擎

### 数据管理（新功能）

**数据导出**:
- 点击「数据管理」标签
- 点击「导出数据」按钮
- 下载 JSON 格式的完整数据备份

**数据导入**:
- 点击「选择文件导入」
- 选择之前导出的 JSON 文件
- 确认导入（会覆盖当前所有数据）
- 自动刷新页面

## 新功能演示

### 拖拽排序
1. 鼠标悬停在分类或网站左侧的拖拽图标（≡）上
2. 按住鼠标左键拖动到目标位置
3. 释放鼠标，排序自动保存
4. 刷新页面验证排序保持

### 数据导入/导出
1. 在「数据管理」中导出当前数据（JSON格式）
2. 修改数据后可以导入之前的备份
3. 支持账户间数据迁移
4. **支持多种格式**：
   - **JSON文件**：本系统导出的数据文件
   - **HTML文件**：浏览器导出的书签文件（Chrome、Firefox、Edge等）

#### HTML书签导入
系统支持导入浏览器导出的HTML书签文件：
1. 从浏览器书签管理器中导出书签为HTML格式
2. 在「数据管理」中选择HTML文件进行导入
3. 系统会自动解析书签结构，分类和网站将按照浏览器的分类组织
4. 会自动为常见网站设置合适的emoji图标

## 安全性

- **RLS 策略**: 所有数据库表都启用了行级安全
- **用户隔离**: 用户只能访问自己的数据
- **认证保护**: 管理功能需要登录才能访问
- **环境变量**: 敏感信息存储在环境变量中
- **隐藏管理入口**: 管理后台通过 `/admin` URL 访问，不在前端显示按钮

## 常见问题

### 如何重置密码？

目前需要通过 Supabase 控制台手动重置。

### 拖拽排序没有保存？

请检查网络连接，排序会在拖拽完成后自动保存到数据库。

### 数据导入失败？

- **JSON格式**：确保导入的JSON文件是本系统导出的格式
- **HTML格式**：确保HTML文件是从浏览器书签管理器导出的标准格式
- 检查文件是否损坏或格式错误
- 确认导入操作在管理后台中执行

### 支持多用户吗？

是的，每个用户拥有独立的导航数据。

## 更新日志

### v2.3.0 (2025-11-02)
- **UI布局优化**：缩小标题和搜索框区域，提升空间利用率
- **网站图标增大**：emoji图标从text-5xl增至text-6xl，视觉效果提升30%
- **紧凑布局**：减少标题区域空间占用50%，搜索区域占用30%
- **卡片优化**：增大网站卡片padding和字体，更易点击和识别
- **整体提升**：页面布局更加平衡，信息层次更清晰

### v2.2.0 (2025-11-02)
- **日期天气合并**：将日期和天气信息合并到右上角统一组件
- **界面优化**：使用分隔线区分日期和天气信息
- **布局改进**：简化导航栏，预留未来功能空间
- **视觉统一**：提供更加整洁的用户界面

### v2.1.0 (2025-11-01)
- 新增智能天气系统，支持右上角天气显示
- 添加自动天气同步功能，更改城市后自动获取天气
- 实现多种天气动画效果（淡入、弹跳、光晕等）
- 根据天气状况动态切换图标
- 优化天气数据的显示和交互体验
- 新增HTML书签文件导入支持
- 自动图标分配功能
- 智能分类结构解析
- 改进的错误处理机制

### v2.0.0 (2025-11-01)
- 新增拖拽排序功能（分类和网站）
- 新增数据导入/导出功能
- 优化所有操作的加载状态反馈
- 添加全局加载遮罩
- 改进错误提示

### v1.0.0 (2025-11-01)
- 初始版本发布
- 用户认证系统
- 基本的 CRUD 功能
- Matrix 背景效果

## 许可证

MIT License

## 作者

MiniMax Agent

## 相关文档

- [Cloudflare 部署指南](./CLOUDFLARE_DEPLOY.md)
- [完整版本交付文档](./COMPLETE_VERSION_DELIVERY.md)
- [部署总结](./DEPLOYMENT_SUMMARY.md)
